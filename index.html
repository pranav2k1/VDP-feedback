<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RBSM Tracker - Officer Portal</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Poppins', sans-serif;
            background: #f0f4f8;
            color: #333;
            line-height: 1.6;
        }
        .header {
            background: #ffffff;
            color: #1a73e8;
            padding: 15px 30px;
            position: sticky;
            top: 0;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #e0e0e0;
        }
        .header-left, .header-right {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .header img { height: 50px; }
        .header h1 { font-size: 24px; }
        .profile-name {
            font-weight: 600;
            color: #333;
            font-size: 14px;
        }
        .header .logout-btn {
            background: #ff4444;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s;
            color: white;
            border: none;
        }
        .header .logout-btn:hover { background: #cc0000; }
        .container {
            display: flex;
            min-height: calc(100vh - 81px);
        }
        .sidebar {
            width: 250px;
            background: #fff;
            padding: 20px;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.05);
            position: fixed;
            height: 100%;
            overflow-y: auto;
        }
        .sidebar h2 {
            color: #1a73e8;
            margin-bottom: 20px;
        }
        .sidebar a {
            display: block;
            padding: 10px;
            color: #555;
            text-decoration: none;
            border-radius: 5px;
            margin-bottom: 10px;
            transition: all 0.3s;
        }
        .sidebar a:hover, .sidebar a.active {
            background: #1a73e8;
            color: white;
            transform: translateX(5px);
        }
        .main-content {
            margin-left: 250px;
            padding: 30px;
            flex-grow: 1;
        }
        .card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 25px;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            border-top: 4px solid #1a73e8;
            display: none;
        }
        .card.active { display: block; }
        .card h2 {
            color: #1a73e8;
            margin-bottom: 20px;
            font-size: 24px;
        }
        .filter-section {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
        }
        .filter-group { flex: 1 1 auto; min-width: 150px; }
        .filter-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            font-size: 13px;
            color: #555;
        }
        .filter-group input[type="text"],
        .filter-group input[type="number"],
        .filter-group input[type="date"],
        .filter-group select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 14px;
            box-sizing: border-box;
        }
        .filter-group .button {
            width: auto;
            padding: 8px 15px;
            font-size: 13px;
            margin-top: 5px;
        }
        .filter-actions {
            flex-basis: 100%;
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 10px;
        }
        .filter-actions .button { padding: 8px 15px; font-size: 13px; }
        .table-wrapper { overflow-x: auto; margin-bottom: 15px; }
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
        }
        th, td {
            border: 1px solid #e0e0e0;
            padding: 12px;
            text-align: left;
            font-size: 14px;
        }
        th {
            background: #1a73e8;
            color: white;
            font-weight: 600;
        }
        tr:nth-child(even) { background: #f8f9fa; }
        tr:hover { background: #eef2f7; }
        .button {
            padding: 8px 15px;
            background: #1a73e8;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: background 0.3s;
        }
        .button:hover { background: #1557b0; }
        #officer-login-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background: linear-gradient(135deg, #1a73e8, #34c759);
            color: white;
            padding: 20px;
            animation: fadeIn 1s ease-in;
        }
        #officer-login-section .login-container {
            background: rgba(255, 255, 255, 0.98);
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 15px 25px rgba(0,0,0,0.15), 0 5px 10px rgba(0,0,0,0.05);
            text-align: center;
            max-width: 400px;
            width: 100%;
        }
        #officer-login-section .logo { height: 70px; margin-bottom: 20px; }
        #officer-login-section h2 { color: #1a73e8; font-size: 26px; margin-bottom: 10px; }
        #officer-login-section p { color: #555; margin-bottom: 15px; font-size: 14px; }
        #officer-login-section .login-form-group { margin-bottom: 15px; text-align: left; }
        #officer-login-section label {
            display: block;
            color: #333;
            font-weight: 600;
            margin-bottom: 5px;
            font-size: 14px;
        }
        #officer-login-section input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 14px;
        }
        #officer-login-section .button { width: 100%; padding: 10px; font-size: 15px; margin-top: 15px; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .metric-card {
            background: linear-gradient(145deg, #ffffff, #f9f9f9);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.07);
            text-align: center;
            border-left: 4px solid #1a73e8;
            transition: all 0.3s ease;
        }
        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.12);
        }
        .metric-card h3 {
            color: #1a73e8;
            margin-bottom: 8px;
            font-size: 14px;
        }
        .metric-card p {
            font-size: 24px;
            font-weight: 600;
            color: #333;
        }
        .charts {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 20px;
        }
        .chart-container {
            position: relative;
            background: #fff;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            aspect-ratio: 1 / 1;
            max-width: 400px;
            margin: 0 auto;
            transition: all 0.3s ease;
        }
        .chart-container:hover {
            transform: scale(1.03);
        }
        canvas {
            width: 100% !important;
            height: 100% !important;
        }
        @media (max-width: 992px) {
            .charts { grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); }
            .chart-container { max-width: unset; }
        }
        @media (max-width: 768px) {
            .sidebar {
                width: 200px;
                transform: translateX(-100%);
                transition: transform 0.3s;
                z-index: 1100;
            }
            .sidebar.active { transform: translateX(0); }
            .main-content { margin-left: 0; padding: 15px; }
            .header { padding: 10px 20px; }
            .header-left h1 { display: none; }
            .header::before {
                content: "â˜°";
                font-size: 24px;
                cursor: pointer;
                color: #1a73e8;
            }
            .metrics { grid-template-columns: repeat(2, 1fr); }
            .charts { grid-template-columns: 1fr; }
            .chart-container { max-width: 100%; aspect-ratio: unset; height: 300px; }
        }
    </style>
</head>
<body>
    <div id="officer-login-section">
        <div class="login-container">
            <img src="https://pplx-res.cloudinary.com/image/upload/v1743155787/user_uploads/RTGqaImkMNPfACk/apmsme_logo-1.jpg" alt="APMSME Logo" class="logo">
            <h2>Officer Login - RBSM Tracker</h2>
            <p>Sign in to monitor and analyze data</p>
            <div class="login-form-group">
                <label for="officer-username">Username</label>
                <input type="text" id="officer-username" placeholder="Enter your username" />
            </div>
            <div class="login-form-group">
                <label for="officer-password">Password</label>
                <input type="password" id="officer-password" placeholder="Enter your password" />
            </div>
            <button class="button" onclick="officerLogin()">Login</button>
        </div>
    </div>

    <div id="officer-dashboard" style="display: none;">
        <div class="header">
            <div class="header-left">
                <img src="https://pplx-res.cloudinary.com/image/upload/v1743155787/user_uploads/RTGqaImkMNPfACk/apmsme_logo-1.jpg" alt="APMSME Logo">
                <h1>RBSM Tracker</h1>
            </div>
            <div class="header-right">
                <span id="profile-name" class="profile-name"></span>
                <button class="logout-btn" onclick="officerLogout()">Logout</button>
            </div>
        </div>
        <div class="container">
            <div class="sidebar">
                <h2>Navigation</h2>
                <a href="#dashboard" class="active">Dashboard</a>
                <a href="#sellers">Sellers</a>
                <a href="#mous">MOUs</a>
                <a href="#orders">Orders</a>
                <a href="#issues">Issues</a>
            </div>
            <div class="main-content">
                <div class="card active" id="dashboard">
                    <h2>Dashboard Overview</h2>
                    <div class="metrics">
                        <div class="metric-card">
                            <h3>Total Sellers</h3>
                            <p id="total-sellers">0</p>
                        </div>
                        <div class="metric-card">
                            <h3>Total MOUs</h3>
                            <p id="total-mous">0</p>
                        </div>
                        <div class="metric-card">
                            <h3>Total Orders</h3>
                            <p id="total-orders">0</p>
                        </div>
                        <div class="metric-card">
                            <h3>Total Issues</h3>
                            <p id="total-issues">0</p>
                        </div>
                        <div class="metric-card">
                            <h3>Open Issues</h3>
                            <p id="open-issues">0</p>
                        </div>
                        <div class="metric-card">
                            <h3>Total MOU Value</h3>
                            <p id="total-mou-value">$0</p>
                        </div>
                        <div class="metric-card">
                            <h3>Total Realized Value</h3>
                            <p id="total-realized-value">$0</p>
                        </div>
                    </div>
                    <div class="charts">
                        <div class="chart-container">
                            <canvas id="order-status-chart"></canvas>
                        </div>
                        <div class="chart-container">
                            <canvas id="sellers-district-chart"></canvas>
                        </div>
                        <div class="chart-container">
                            <canvas id="mou-value-event-chart"></canvas>
                        </div>
                        <div class="chart-container">
                            <canvas id="issue-type-chart"></canvas>
                        </div>
                        <div class="chart-container">
                            <canvas id="order-value-trend-chart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="card" id="sellers">
                    <h2>Sellers Data</h2>
                    <div class="filter-section">
                        <div class="filter-group">
                            <label for="filter-sellers-name">Seller Name</label>
                            <input type="text" id="filter-sellers-name" placeholder="Search by name">
                        </div>
                        <div class="filter-group">
                            <label for="filter-sellers-district">District</label>
                            <select id="filter-sellers-district">
                                <option value="">All</option>
                                <option value="Anantapur">Anantapur</option>
                                <option value="Visakhapatnam">Visakhapatnam</option>
                                <option value="Guntur">Guntur</option>
                                <option value="Kurnool">Kurnool</option>
                                <option value="Chittoor">Chittoor</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="filter-sellers-unit-category">Unit Category</label>
                            <select id="filter-sellers-unit-category">
                                <option value="">All</option>
                                <option value="Micro">Micro</option>
                                <option value="Small">Small</option>
                                <option value="Medium">Medium</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="filter-sellers-gender">Gender</label>
                            <select id="filter-sellers-gender">
                                <option value="">All</option>
                                <option value="Male">Male</option>
                                <option value="Female">Female</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="filter-sellers-social-status">Social Status</label>
                            <select id="filter-sellers-social-status">
                                <option value="">All</option>
                                <option value="General">General</option>
                                <option value="OBC">OBC</option>
                                <option value="SC">SC</option>
                                <option value="ST">ST</option>
                            </select>
                        </div>
                        <div class="filter-actions">
                            <button class="button" onclick="applySellersFilters()">Apply Filters</button>
                            <button class="button" onclick="clearSellersFilters()">Clear Filters</button>
                        </div>
                    </div>
                    <button class="button" style="margin-bottom: 10px;" onclick="exportTableToExcel('sellers-table', 'Sellers_Data')">Export to Excel</button>
                    <div class="table-wrapper">
                        <table id="sellers-table">
                            <thead>
                                <tr>
                                    <th>Seller Name</th>
                                    <th>Gender</th>
                                    <th>Social Status</th>
                                    <th>Unit Category</th>
                                    <th>District</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>ABC Exports</td>
                                    <td>Male</td>
                                    <td>General</td>
                                    <td>Micro</td>
                                    <td>Anantapur</td>
                                </tr>
                                <tr>
                                    <td>XYZ Ltd</td>
                                    <td>Female</td>
                                    <td>OBC</td>
                                    <td>Small</td>
                                    <td>Visakhapatnam</td>
                                </tr>
                                <tr>
                                    <td>DEF Enterprises</td>
                                    <td>Female</td>
                                    <td>SC</td>
                                    <td>Medium</td>
                                    <td>Guntur</td>
                                </tr>
                                <tr>
                                    <td>Global Spices</td>
                                    <td>Male</td>
                                    <td>General</td>
                                    <td>Micro</td>
                                    <td>Kurnool</td>
                                </tr>
                                <tr>
                                    <td>Heritage Crafts</td>
                                    <td>Female</td>
                                    <td>ST</td>
                                    <td>Small</td>
                                    <td>Chittoor</td>
                                </tr>
                                <tr>
                                    <td>Tech Solutions</td>
                                    <td>Male</td>
                                    <td>OBC</td>
                                    <td>Medium</td>
                                    <td>Anantapur</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="card" id="mous">
                    <h2>MOU Data</h2>
                    <div class="filter-section">
                        <div class="filter-group">
                            <label for="filter-mous-buyer-name">Buyer Name</label>
                            <input type="text" id="filter-mous-buyer-name" placeholder="Search by buyer name">
                        </div>
                        <div class="filter-group">
                            <label for="filter-mous-seller-name">Seller Name</label>
                            <input type="text" id="filter-mous-seller-name" placeholder="Search by seller name">
                        </div>
                        <div class="filter-group">
                            <label for="filter-mous-event">RBSM Event</label>
                            <select id="filter-mous-event">
                                <option value="">All</option>
                                <option value="RBSM 2024">RBSM 2024</option>
                                <option value="RBSM 2025">RBSM 2025</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="filter-mous-status">Status</label>
                            <select id="filter-mous-status">
                                <option value="">All</option>
                                <option value="Pending">Pending</option>
                                <option value="In Progress">In Progress</option>
                                <option value="Completed">Completed</option>
                                <option value="Cancelled">Cancelled</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="filter-mous-value-min">MOU Value (Min)</label>
                            <input type="number" id="filter-mous-value-min" placeholder="Min value">
                        </div>
                        <div class="filter-group">
                            <label for="filter-mous-value-max">MOU Value (Max)</label>
                            <input type="number" id="filter-mous-value-max" placeholder="Max value">
                        </div>
                        <div class="filter-group">
                            <label for="filter-mous-product">Product</label>
                            <input type="text" id="filter-mous-product" placeholder="Search by product">
                        </div>
                        <div class="filter-actions">
                            <button class="button" onclick="applyMOUFilters()">Apply Filters</button>
                            <button class="button" onclick="clearMOUFilters()">Clear Filters</button>
                        </div>
                    </div>
                    <button class="button" style="margin-bottom: 10px;" onclick="exportTableToExcel('mous-table', 'MOUs_Data')">Export to Excel</button>
                    <div class="table-wrapper">
                        <table id="mous-table">
                            <thead>
                                <tr>
                                    <th>Buyer Name</th>
                                    <th>Seller Name</th>
                                    <th>MOU Value</th>
                                    <th>Realized Value</th>
                                    <th>Date Signed</th>
                                    <th>RBSM Event</th>
                                    <th>Product</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>XYZ Ltd (USA)</td>
                                    <td>ABC Exports</td>
                                    <td>$50,000</td>
                                    <td>$0</td>
                                    <td>2025-06-16</td>
                                    <td>RBSM 2025</td>
                                    <td>Handicrafts</td>
                                    <td>Pending</td>
                                </tr>
                                <tr>
                                    <td>ABC Corp (UK)</td>
                                    <td>XYZ Ltd</td>
                                    <td>$75,000</td>
                                    <td>$30,000</td>
                                    <td>2024-12-10</td>
                                    <td>RBSM 2024</td>
                                    <td>Textiles</td>
                                    <td>In Progress</td>
                                </tr>
                                <tr>
                                    <td>Global Traders (AU)</td>
                                    <td>Global Spices</td>
                                    <td>$100,000</td>
                                    <td>$80,000</td>
                                    <td>2025-01-15</td>
                                    <td>RBSM 2025</td>
                                    <td>Spices</td>
                                    <td>Completed</td>
                                </tr>
                                <tr>
                                    <td>European Imports</td>
                                    <td>Heritage Crafts</td>
                                    <td>$20,000</td>
                                    <td>$20,000</td>
                                    <td>2024-11-20</td>
                                    <td>RBSM 2024</td>
                                    <td>Jewellery</td>
                                    <td>Completed</td>
                                </tr>
                                <tr>
                                    <td>Asian Distributors</td>
                                    <td>Tech Solutions</td>
                                    <td>$120,000</td>
                                    <td>$0</td>
                                    <td>2025-05-01</td>
                                    <td>RBSM 2025</td>
                                    <td>Agri Products</td>
                                    <td>Pending</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="card" id="orders">
                    <h2>Orders Data</h2>
                    <div class="filter-section">
                        <div class="filter-group">
                            <label for="filter-orders-id">Order ID</label>
                            <input type="text" id="filter-orders-id" placeholder="Search by Order ID">
                        </div>
                        <div class="filter-group">
                            <label for="filter-orders-buyer-name">Buyer Name</label>
                            <input type="text" id="filter-orders-buyer-name" placeholder="Search by buyer name">
                        </div>
                        <div class="filter-group">
                            <label for="filter-orders-product">Product</label>
                            <input type="text" id="filter-orders-product" placeholder="Search by product">
                        </div>
                        <div class="filter-group">
                            <label for="filter-orders-status">Status</label>
                            <select id="filter-orders-status">
                                <option value="">All</option>
                                <option value="Pending">Pending</option>
                                <option value="Shipped">Shipped</option>
                                <option value="Delivered">Delivered</option>
                                <option value="Cancelled">Cancelled</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="filter-orders-value-min">Order Value (Min)</label>
                            <input type="number" id="filter-orders-value-min" placeholder="Min value">
                        </div>
                        <div class="filter-group">
                            <label for="filter-orders-value-max">Order Value (Max)</label>
                            <input type="number" id="filter-orders-value-max" placeholder="Max value">
                        </div>
                        <div class="filter-group">
                            <label for="filter-orders-date-order-min">Date of Order (Start)</label>
                            <input type="date" id="filter-orders-date-order-min">
                        </div>
                        <div class="filter-group">
                            <label for="filter-orders-date-order-max">Date of Order (End)</label>
                            <input type="date" id="filter-orders-date-order-max">
                        </div>
                        <div class="filter-actions">
                            <button class="button" onclick="applyOrdersFilters()">Apply Filters</button>
                            <button class="button" onclick="clearOrdersFilters()">Clear Filters</button>
                        </div>
                    </div>
                    <button class="button" style="margin-bottom: 10px;" onclick="exportTableToExcel('orders-table', 'Orders_Data')">Export to Excel</button>
                    <div class="table-wrapper">
                        <table id="orders-table">
                            <thead>
                                <tr>
                                    <th>Order ID</th>
                                    <th>Buyer Name</th>
                                    <th>Product</th>
                                    <th>Order Value</th>
                                    <th>Date of Order</th>
                                    <th>Date of Supply</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>ORD12345</td>
                                    <td>XYZ Ltd (USA)</td>
                                    <td>Handicrafts</td>
                                    <td>$10,000</td>
                                    <td>2025-03-10</td>
                                    <td>2025-04-05</td>
                                    <td>Delivered</td>
                                </tr>
                                <tr>
                                    <td>ORD12346</td>
                                    <td>ABC Corp (UK)</td>
                                    <td>Textiles</td>
                                    <td>$15,000</td>
                                    <td>2025-03-12</td>
                                    <td>2025-04-10</td>
                                    <td>Shipped</td>
                                </tr>
                                <tr>
                                    <td>ORD12347</td>
                                    <td>Global Traders (AU)</td>
                                    <td>Spices</td>
                                    <td>$20,000</td>
                                    <td>2025-02-01</td>
                                    <td>2025-03-15</td>
                                    <td>Delivered</td>
                                </tr>
                                <tr>
                                    <td>ORD12348</td>
                                    <td>European Imports</td>
                                    <td>Jewellery</td>
                                    <td>$5,000</td>
                                    <td>2025-04-01</td>
                                    <td>2025-04-20</td>
                                    <td>Pending</td>
                                </tr>
                                <tr>
                                    <td>ORD12349</td>
                                    <td>Asian Distributors</td>
                                    <td>Agri Products</td>
                                    <td>$30,000</td>
                                    <td>2025-05-15</td>
                                    <td></td>
                                    <td>Pending</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="card" id="issues">
                    <h2>Issues Tracking</h2>
                    <div class="filter-section">
                        <div class="filter-group">
                            <label for="filter-issues-id">Issue ID</label>
                            <input type="text" id="filter-issues-id" placeholder="Search by Issue ID">
                        </div>
                        <div class="filter-group">
                            <label for="filter-issues-order-id">Order ID</label>
                            <input type="text" id="filter-issues-order-id" placeholder="Search by Order ID">
                        </div>
                        <div class="filter-group">
                            <label for="filter-issues-type">Issue Type</label>
                            <select id="filter-issues-type">
                                <option value="">All</option>
                                <option value="Logistics Delay">Logistics Delay</option>
                                <option value="Payment Issues">Payment Issues</option>
                                <option value="Product Quality Concerns">Product Quality Concerns</option>
                                <option value="Regulatory">Regulatory</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="filter-issues-status">Status</label>
                            <select id="filter-issues-status">
                                <option value="">All</option>
                                <option value="Open">Open</option>
                                <option value="In Progress">In Progress</option>
                                <option value="Resolved">Resolved</option>
                                <option value="Closed">Closed</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="filter-issues-reported-min">Reported At (Start)</label>
                            <input type="date" id="filter-issues-reported-min">
                        </div>
                        <div class="filter-group">
                            <label for="filter-issues-reported-max">Reported At (End)</label>
                            <input type="date" id="filter-issues-reported-max">
                        </div>
                        <div class="filter-group">
                            <label for="filter-issues-details">Details</label>
                            <input type="text" id="filter-issues-details" placeholder="Search in details">
                        </div>
                        <div class="filter-actions">
                            <button class="button" onclick="applyIssuesFilters()">Apply Filters</button>
                            <button class="button" onclick="clearIssuesFilters()">Clear Filters</button>
                        </div>
                    </div>
                    <button class="button" style="margin-bottom: 10px;" onclick="exportTableToExcel('issues-table', 'Issues_Data')">Export to Excel</button>
                    <div class="table-wrapper">
                        <table id="issues-table">
                            <thead>
                                <tr>
                                    <th>Issue ID</th>
                                    <th>Order ID</th>
                                    <th>Issue Type</th>
                                    <th>Details</th>
                                    <th>Reported At</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>ISS00001</td>
                                    <td>ORD12345</td>
                                    <td>Logistics Delay</td>
                                    <td>Shipment delayed by 2 weeks</td>
                                    <td>2025-03-15 10:00</td>
                                    <td>Open</td>
                                </tr>
                                <tr>
                                    <td>ISS00002</td>
                                    <td>ORD12346</td>
                                    <td>Payment Issues</td>
                                    <td>Payment not received</td>
                                    <td>2025-03-20 14:30</td>
                                    <td>In Progress</td>
                                </tr>
                                <tr>
                                    <td>ISS00003</td>
                                    <td>ORD12347</td>
                                    <td>Product Quality Concerns</td>
                                    <td>Defective items reported</td>
                                    <td>2025-03-25 09:00</td>
                                    <td>Open</td>
                                </tr>
                                <tr>
                                    <td>ISS00004</td>
                                    <td>ORD12348</td>
                                    <td>Regulatory</td>
                                    <td>Permit issues for export</td>
                                    <td>2025-04-10 11:00</td>
                                    <td>In Progress</td>
                                </tr>
                                <tr>
                                    <td>ISS00005</td>
                                    <td></td>
                                    <td>Other</td>
                                    <td>General inquiry about RBSM participation</td>
                                    <td>2025-05-01 16:00</td>
                                    <td>Closed</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- Chart.js Global Font Settings ---
        Chart.defaults.font.family = "'Poppins', sans-serif";

        function officerLogin() {
            const username = document.getElementById("officer-username").value;
            const password = document.getElementById("officer-password").value;
            if (username.trim() !== "" && password.trim() !== "") {
                document.getElementById("officer-login-section").style.display = "none";
                document.getElementById("officer-dashboard").style.display = "block";
                document.getElementById("profile-name").textContent = `Welcome, ${username}`;
                loadDashboardData();
            } else {
                alert("Please enter both username and password.");
            }
        }

        function officerLogout() {
            document.getElementById("officer-dashboard").style.display = "none";
            document.getElementById("officer-login-section").style.display = "flex";
            document.getElementById("officer-username").value = "";
            document.getElementById("officer-password").value = "";
            document.getElementById("profile-name").textContent = "";
        }

        function loadDashboardData() {
            document.getElementById("total-sellers").textContent = "75";
            document.getElementById("total-mous").textContent = "150";
            document.getElementById("total-orders").textContent = "300";
            document.getElementById("total-issues").textContent = "15";
            document.getElementById("open-issues").textContent = "8";
            document.getElementById("total-mou-value").textContent = "$2.5M";
            document.getElementById("total-realized-value").textContent = "$1.2M";

            // Order Status Pie Chart
            const ctx1 = document.getElementById('order-status-chart').getContext('2d');
            new Chart(ctx1, {
                type: 'pie',
                data: {
                    labels: ['Pending', 'In Progress', 'Completed', 'Cancelled'],
                    datasets: [{
                        data: [50, 30, 60, 10],
                        backgroundColor: ['#ffcc00', '#1a73e8', '#34c759', '#ff4444'],
                        borderColor: '#fff',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { 
                            position: 'top', 
                            labels: { 
                                usePointStyle: true, 
                                pointStyle: 'circle',
                                font: { size: 11 }
                            } 
                        },
                        title: { 
                            display: true, 
                            text: 'Order Status Distribution', 
                            font: { size: 16 }, 
                            padding: { top: 10, bottom: 15 } 
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const total = context.dataset.data.reduce((sum, value) => sum + value, 0);
                                    const value = context.raw;
                                    const percentage = ((value / total) * 100).toFixed(1);
                                    return `${context.label}: ${value} (${percentage}%)`;
                                }
                            }
                        },
                        datalabels: {
                            formatter: (value, context) => {
                                const total = context.dataset.data.reduce((sum, value) => sum + value, 0);
                                const percentage = ((value / total) * 100).toFixed(1);
                                return `${percentage}%`;
                            },
                            color: '#fff',
                            font: {
                                weight: 'bold',
                                size: 12
                            },
                            anchor: 'center',
                            align: 'center'
                        }
                    }
                },
                plugins: [ChartDataLabels]
            });

            // Sellers by District Bar Chart
            const ctx2 = document.getElementById('sellers-district-chart').getContext('2d');
            new Chart(ctx2, {
                type: 'bar',
                data: {
                    labels: ['Anantapur', 'Visakhapatnam', 'Guntur', 'Kurnool', 'Chittoor'],
                    datasets: [{
                        label: 'Number of Sellers',
                        data: [20, 25, 15, 10, 5],
                        backgroundColor: '#1a73e8',
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        title: { display: true, text: 'Sellers by District', font: { size: 16 }, padding: { top: 10, bottom: 15 } }
                    },
                    scales: {
                        y: { beginAtZero: true, grid: { display: false } },
                        x: { grid: { display: false } }
                    }
                }
            });

            // MOU Value Breakdown by RBSM Event Stacked Bar Chart
            const ctx3 = document.getElementById('mou-value-event-chart').getContext('2d');
            new Chart(ctx3, {
                type: 'bar',
                data: {
                    labels: ['RBSM 2024', 'RBSM 2025'],
                    datasets: [
                        {
                            label: 'Realised Value ($)',
                            data: [750000, 450000],
                            backgroundColor: '#1a73e8',
                            borderRadius: 4
                        },
                        {
                            label: 'Unrealised Value ($)',
                            data: [250000, 1050000],
                            backgroundColor: '#a9cce3',
                            borderRadius: 4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { 
                            position: 'top', 
                            labels: { 
                                usePointStyle: true, 
                                pointStyle: 'circle',
                                font: { size: 11 }
                            } 
                        },
                        title: { display: true, text: 'MOU Value Breakdown', font: { size: 16 }, padding: { top: 10, bottom: 15 } }
                    },
                    scales: {
                        x: { stacked: true, grid: { display: false } },
                        y: { stacked: true, beginAtZero: true, grid: { color: '#eef2f7' }, ticks: { callback: value => '$' + (value/1000) + 'K' } }
                    }
                }
            });

            // Issue Type Doughnut Chart
            const ctx4 = document.getElementById('issue-type-chart').getContext('2d');
            new Chart(ctx4, {
                type: 'doughnut',
                data: {
                    labels: ['Logistics', 'Payment', 'Quality', 'Regulatory', 'Other'],
                    datasets: [{
                        data: [5, 4, 3, 2, 1],
                        backgroundColor: ['#ff4444', '#ffcc00', '#1a73e8', '#34c759', '#666'],
                        borderColor: '#fff',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { 
                            position: 'top', 
                            labels: { 
                                usePointStyle: true, 
                                pointStyle: 'circle',
                                font: { size: 11 }
                            } 
                        },
                        title: { display: true, text: 'Issue Type Distribution', font: { size: 16 }, padding: { top: 10, bottom: 15 } },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const total = context.dataset.data.reduce((sum, value) => sum + value, 0);
                                    const value = context.raw;
                                    const percentage = ((value / total) * 100).toFixed(1);
                                    return `${context.label}: ${value} (${percentage}%)`;
                                }
                            }
                        },
                        datalabels: {
                            formatter: (value, context) => {
                                const total = context.dataset.data.reduce((sum, value) => sum + value, 0);
                                const percentage = ((value / total) * 100).toFixed(1);
                                return `${percentage}%`;
                            },
                            color: '#fff',
                            font: {
                                weight: 'bold',
                                size: 12
                            },
                            anchor: 'center',
                            align: 'center'
                        }
                    }
                },
                plugins: [ChartDataLabels]
            });

            // Order Value Trend Line Chart
            const ctx5 = document.getElementById('order-value-trend-chart').getContext('2d');
            new Chart(ctx5, {
                type: 'line',
                data: {
                    labels: ['Jan 2025', 'Feb 2025', 'Mar 2025', 'Apr 2025', 'May 2025', 'Jun 2025'],
                    datasets: [{
                        label: 'Order Value ($)',
                        data: [100000, 150000, 200000, 180000, 220000, 250000],
                        borderColor: '#1a73e8',
                        backgroundColor: 'rgba(26, 115, 232, 0.1)',
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: '#1a73e8',
                        pointRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        title: { display: true, text: 'Monthly Order Value Trend', font: { size: 16 }, padding: { top: 10, bottom: 15 } }
                    },
                    scales: {
                        y: { beginAtZero: false, grid: { color: '#eef2f7' }, ticks: { callback: value => '$' + (value / 1000) + 'K' } },
                        x: { grid: { display: false } }
                    }
                }
            });
        }

        function showSection(sectionId) {
            document.querySelectorAll('.card').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(sectionId).classList.add('active');

            document.querySelectorAll('.sidebar a').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === `#${sectionId}`) {
                    link.classList.add('active');
                }
            });
            if (window.innerWidth <= 768) {
                document.querySelector('.sidebar').classList.remove('active');
            }
        }

        function exportTableToExcel(tableId, fileName) {
            const table = document.getElementById(tableId);
            const wb = XLSX.utils.table_to_book(table, { sheet: "Sheet1" });
            XLSX.writeFile(wb, fileName + '.xlsx');
        }

        function applySellersFilters() {
            const tableName = 'sellers-table';
            const table = document.getElementById(tableName);
            const rows = table.getElementsByTagName('tbody')[0].getElementsByTagName('tr');
            const nameFilter = document.getElementById('filter-sellers-name').value.toLowerCase();
            const districtFilter = document.getElementById('filter-sellers-district').value;
            const unitCategoryFilter = document.getElementById('filter-sellers-unit-category').value;
            const genderFilter = document.getElementById('filter-sellers-gender').value;
            const socialStatusFilter = document.getElementById('filter-sellers-social-status').value;
            for (let i = 0; i < rows.length; i++) {
                const row = rows[i];
                const sellerName = row.cells[0].textContent.toLowerCase();
                const gender = row.cells[1].textContent;
                const socialStatus = row.cells[2].textContent;
                const unitCategory = row.cells[3].textContent;
                const district = row.cells[4].textContent;
                const nameMatch = sellerName.includes(nameFilter);
                const districtMatch = districtFilter === "" || district === districtFilter;
                const unitCategoryMatch = unitCategoryFilter === "" || unitCategory === unitCategoryFilter;
                const genderMatch = genderFilter === "" || gender === genderFilter;
                const socialStatusMatch = socialStatusFilter === "" || socialStatus === socialStatusFilter;
                if (nameMatch && districtMatch && unitCategoryMatch && genderMatch && socialStatusMatch) {
                    row.style.display = "";
                } else {
                    row.style.display = "none";
                }
            }
        }

        function clearSellersFilters() {
            document.getElementById('filter-sellers-name').value = "";
            document.getElementById('filter-sellers-district').value = "";
            document.getElementById('filter-sellers-unit-category').value = "";
            document.getElementById('filter-sellers-gender').value = "";
            document.getElementById('filter-sellers-social-status').value = "";
            applySellersFilters();
        }

        function applyMOUFilters() {
            const tableName = 'mous-table';
            const table = document.getElementById(tableName);
            const rows = table.getElementsByTagName('tbody')[0].getElementsByTagName('tr');
            const buyerNameFilter = document.getElementById('filter-mous-buyer-name').value.toLowerCase();
            const sellerNameFilter = document.getElementById('filter-mous-seller-name').value.toLowerCase();
            const eventFilter = document.getElementById('filter-mous-event').value;
            const statusFilter = document.getElementById('filter-mous-status').value;
            const valueMinFilter = parseFloat(document.getElementById('filter-mous-value-min').value) || 0;
            const valueMaxFilter = parseFloat(document.getElementById('filter-mous-value-max').value) || Infinity;
            const productFilter = document.getElementById('filter-mous-product').value.toLowerCase();
            for (let i = 0; i < rows.length; i++) {
                const row = rows[i];
                const buyerName = row.cells[0].textContent.toLowerCase();
                const sellerName = row.cells[1].textContent.toLowerCase();
                const mouValue = parseFloat(row.cells[2].textContent.replace(/[$,]/g, '')) || 0;
                const rbsmEvent = row.cells[5].textContent;
                const product = row.cells[6].textContent.toLowerCase();
                const status = row.cells[7].textContent;

                const buyerNameMatch = buyerName.includes(buyerNameFilter);
                const sellerNameMatch = sellerName.includes(sellerNameFilter);
                const eventMatch = eventFilter === "" || rbsmEvent === eventFilter;
                const statusMatch = statusFilter === "" || status === statusFilter;
                const valueMatch = mouValue >= valueMinFilter && mouValue <= valueMaxFilter;
                const productMatch = product.includes(productFilter);

                if (buyerNameMatch && sellerNameMatch && eventMatch && statusMatch && valueMatch && productMatch) {
                    row.style.display = "";
                } else {
                    row.style.display = "none";
                }
            }
        }

        function clearMOUFilters() {
            document.getElementById('filter-mous-buyer-name').value = "";
            document.getElementById('filter-mous-seller-name').value = "";
            document.getElementById('filter-mous-event').value = "";
            document.getElementById('filter-mous-status').value = "";
            document.getElementById('filter-mous-value-min').value = "";
            document.getElementById('filter-mous-value-max').value = "";
            document.getElementById('filter-mous-product').value = "";
            applyMOUFilters();
        }

        function applyOrdersFilters() {
            const tableName = 'orders-table';
            const table = document.getElementById(tableName);
            const rows = table.getElementsByTagName('tbody')[0].getElementsByTagName('tr');
            const orderIdFilter = document.getElementById('filter-orders-id').value.toLowerCase();
            const buyerNameFilter = document.getElementById('filter-orders-buyer-name').value.toLowerCase();
            const productFilter = document.getElementById('filter-orders-product').value.toLowerCase();
            const statusFilter = document.getElementById('filter-orders-status').value;
            const valueMinFilter = parseFloat(document.getElementById('filter-orders-value-min').value) || 0;
            const valueMaxFilter = parseFloat(document.getElementById('filter-orders-value-max').value) || Infinity;
            const dateOrderMinFilter = document.getElementById('filter-orders-date-order-min').value;
            const dateOrderMaxFilter = document.getElementById('filter-orders-date-order-max').value;
            for (let i = 0; i < rows.length; i++) {
                const row = rows[i];
                const orderId = row.cells[0].textContent.toLowerCase();
                const buyerName = row.cells[1].textContent.toLowerCase();
                const product = row.cells[2].textContent.toLowerCase();
                const orderValue = parseFloat(row.cells[3].textContent.replace(/[$,]/g, '')) || 0;
                const dateOfOrder = row.cells[4].textContent;
                const status = row.cells[6].textContent;
                const orderIdMatch = orderId.includes(orderIdFilter);
                const buyerNameMatch = buyerName.includes(buyerNameFilter);
                const productMatch = product.includes(productFilter);
                const statusMatch = statusFilter === "" || status === statusFilter;
                const valueMatch = orderValue >= valueMinFilter && orderValue <= valueMaxFilter;
                let dateOrderMatch = true;
                if (dateOrderMinFilter && dateOfOrder < dateOrderMinFilter) dateOrderMatch = false;
                if (dateOrderMaxFilter && dateOfOrder > dateOrderMaxFilter) dateOrderMatch = false;
                if (orderIdMatch && buyerNameMatch && productMatch && statusMatch && valueMatch && dateOrderMatch) {
                    row.style.display = "";
                } else {
                    row.style.display = "none";
                }
            }
        }

        function clearOrdersFilters() {
            document.getElementById('filter-orders-id').value = "";
            document.getElementById('filter-orders-buyer-name').value = "";
            document.getElementById('filter-orders-product').value = "";
            document.getElementById('filter-orders-status').value = "";
            document.getElementById('filter-orders-value-min').value = "";
            document.getElementById('filter-orders-value-max').value = "";
            document.getElementById('filter-orders-date-order-min').value = "";
            document.getElementById('filter-orders-date-order-max').value = "";
            applyOrdersFilters();
        }

        function applyIssuesFilters() {
            const tableName = 'issues-table';
            const table = document.getElementById(tableName);
            const rows = table.getElementsByTagName('tbody')[0].getElementsByTagName('tr');
            const issueIdFilter = document.getElementById('filter-issues-id').value.toLowerCase();
            const orderIdFilter = document.getElementById('filter-issues-order-id').value.toLowerCase();
            const issueTypeFilter = document.getElementById('filter-issues-type').value;
            const statusFilter = document.getElementById('filter-issues-status').value;
            const reportedMinFilter = document.getElementById('filter-issues-reported-min').value;
            const reportedMaxFilter = document.getElementById('filter-issues-reported-max').value;
            const detailsFilter = document.getElementById('filter-issues-details').value.toLowerCase();
            for (let i = 0; i < rows.length; i++) {
                const row = rows[i];
                const issueId = row.cells[0].textContent.toLowerCase();
                const orderId = row.cells[1].textContent.toLowerCase();
                const issueType = row.cells[2].textContent;
                const details = row.cells[3].textContent.toLowerCase();
                const reportedAtDate = row.cells[4].textContent.split(' ')[0];
                const status = row.cells[5].textContent;
                const issueIdMatch = issueId.includes(issueIdFilter);
                const orderIdMatch = orderId.includes(orderIdFilter);
                const issueTypeMatch = issueTypeFilter === "" || issueType === issueTypeFilter;
                const statusMatch = statusFilter === "" || status === statusFilter;
                const detailsMatch = details.includes(detailsFilter);
                let reportedDateMatch = true;
                if (reportedMinFilter && reportedAtDate < reportedMinFilter) reportedDateMatch = false;
                if (reportedMaxFilter && reportedAtDate > reportedMaxFilter) reportedDateMatch = false;
                if (issueIdMatch && orderIdMatch && issueTypeMatch && statusMatch && reportedDateMatch && detailsMatch) {
                    row.style.display = "";
                } else {
                    row.style.display = "none";
                }
            }
        }

        function clearIssuesFilters() {
            document.getElementById('filter-issues-id').value = "";
            document.getElementById('filter-issues-order-id').value = "";
            document.getElementById('filter-issues-type').value = "";
            document.getElementById('filter-issues-status').value = "";
            document.getElementById('filter-issues-reported-min').value = "";
            document.getElementById('filter-issues-reported-max').value = "";
            document.getElementById('filter-issues-details').value = "";
            applyIssuesFilters();
        }

        document.addEventListener("DOMContentLoaded", function() {
            document.querySelectorAll('.sidebar a').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const sectionId = this.getAttribute('href').substring(1);
                    showSection(sectionId);
                });
            });

            document.querySelector('.header').addEventListener('click', function(e) {
                if (window.innerWidth <= 768 && !e.target.classList.contains('logout-btn') && !e.target.closest('.header-right')) {
                    document.querySelector('.sidebar').classList.toggle('active');
                }
            });

            const passwordInput = document.getElementById("officer-password");
            if (passwordInput) {
                passwordInput.addEventListener("keypress", function(event) {
                    if (event.key === "Enter") {
                        event.preventDefault();
                        officerLogin();
                    }
                });
            }
        });
    </script>
</body>
</html>
